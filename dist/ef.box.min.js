/* @author Alex Franzelin @license Mit license  Written for encaleo */
if("undefined"==typeof ef)var ef={};ef.box={config:{selector:{base:".efBox",type:!0,gallery:"data-gallery"},errors:{image:"Error while loading image.",inline:"Error while loading content."},resizeDynamic:!0,margin:[60,70,60,70],padding:[0,0,0,0],type:"image",width:null,height:null,minWidth:200,minHeight:400,navArrows:!0,speed:200,resizeSpeed:400,closeButton:!0,modal:!1},values:{wWidth:0,wHeight:0,maxWidth:0,maxHeight:0,maxDivWidth:0,maxDivHeight:0,lWidth:0,lHeight:0,left:0,top:0,img:{},content:"",closed:!0,loading:!1,gallery:!1,index:null,galleries:{}},manualOptions:{content:"",autoWidth:!0,autoHeight:!0,width:800,height:600,selector:{base:".efBox",type:!0,gallery:"data-gallery"},errors:{image:"Error while loading image.",inline:"Error while loading content."},resizeDynamic:!0,margin:[60,70,60,70],padding:[0,0,0,0],type:"image",minWidth:700,minHeight:400,navArrows:!0,speed:200,resizeSpeed:400,closeButton:!0,modal:!1},init:function(a){this.configure(a),jQuery("#efBox").length<=0&&this.attach(),this.attachEvents()},attach:function(){jQuery("body").append('<div id="efBox"></div><div id="efBoxOverlay"></div><div id="efBoxLoading"></div>'),jQuery("#efBox").append('<div class="efBoxContent"></div><div class="efBoxClose"></div><div class="efBoxPrev efBoxArrow"></div><div class="efBoxNext efBoxArrow"></div>'),0==this.config.modal&&jQuery("#efBoxOverlay").on("click",this.closeBox)},attachEvents:function(){jQuery(document).on("click",this.config.selector.base,function(a){if(a.preventDefault(),$this=jQuery(this),ef.box.getMaxBoxSize(),ef.box.getMaxImageSize(),$this.data("width")&&(ef.box.config.width=$this.data("width")),$this.data("height")&&(ef.box.config.height=$this.data("height")),"image"!=ef.box.config.type||$this.data("type")&&"image"!=$this.data("type")){if("iframe"==ef.box.config.type||"iframe"==$this.data("type")){var c=ef.box.config.height;ef.box.values.maxDivHeight<ef.box.config.height&&(c=ef.box.values.maxDivHeight),c+=40,ef.box.values.divHeight=c,ef.box.values.content='<iframe src="'+$this.attr("href")+'" width="'+ef.box.config.width+'" height="'+c+'"></iframe>',ef.box.showBox("iframe")}}else{if("undefined"!=typeof $this.attr(ef.box.config.selector.gallery)){var b=$this.attr(ef.box.config.selector.gallery);ef.box.values.gallery=b,"undefined"==typeof ef.box.values.galleries[b]&&(ef.box.values.galleries[b]=jQuery("a["+ef.box.config.selector.gallery+"="+b+"]")),ef.box.values.index=ef.box.values.galleries[b].index(jQuery(this))}else ef.box.values.gallery=!1,ef.box.values.index=null;ef.box.loadImage($this.attr("href"))}}),jQuery(document).on("click",".efBoxArrow",function(){$this=jQuery(this),ef.box.getMaxBoxSize(),ef.box.getMaxImageSize();var b=$this.attr("data-name"),c=parseInt($this.attr("data-index"));return"undefined"==typeof ef.box.values.galleries[b]?!1:($this.hasClass("efBoxPrev")?ef.box.go(b,c):ef.box.go(b,c),void 0)}),jQuery(document).on("click",".efBoxClose",function(){ef.box.closeBox()}),$(document).on("keyup",function(a){0==ef.box.values.closed&&(27==a.keyCode?ef.box.closeBox():37==a.keyCode&&"undefined"!=typeof ef.box.values.gallery?ef.box.values.index>0&&ef.box.go(ef.box.values.gallery,ef.box.values.index-1):39==a.keyCode&&"undefined"!=typeof ef.box.values.gallery&&"undefined"!=typeof ef.box.values.galleries[ef.box.values.gallery]&&ef.box.values.index<ef.box.values.galleries[ef.box.values.gallery].length-1&&ef.box.go(ef.box.values.gallery,ef.box.values.index+1))})},go:function(a,b){ef.box.showLoading(),ef.box.hideContent(),ef.box.removeContent(),ef.box.hidePrev(),ef.box.hideNext(),ef.box.values.gallery=a,ef.box.values.index=b,ef.box.loadImage(ef.box.values.galleries[a][b].href,"changeImage")},configure:function(a){jQuery.extend(this.config,a),1==this.config.resizeDynamic&&(window.onresize=function(){ef.box.getWindowSize()})},loadImage:function(a,b){var c=new Image;this.values.closed=!1,ef.box.values.img=null,ef.box.showLoading(),jQuery("#efBoxOverlay").fadeIn(ef.box.config.speed),c.onload=function(){ef.box.hideLoading(),ef.box.values.img=c,"undefined"==typeof b?ef.box.contentLoaded(ef.box.config.type):ef.box[b]()},c.onerror=function(){ef.box.contentError("image")},c.src=a},changeImage:function(){var a=ef.box.calcImageSize();ef.box.values.content='<img src="'+ef.box.values.img.src+'" '+a+' alt="img" />',jQuery(".efBoxContent").html(ef.box.values.content),ef.box.setBoxSize(!0,"showContent")},calcBoxSize:function(a,b,c){var d=ef.box.values.maxHeight/a,e=ef.box.values.maxWidth/b,f="";return b>ef.box.values.maxWidth?a>ef.box.values.maxHeight?d*b<=ef.box.values.maxWidth?(f='height="'+ef.box.values.maxHeight+'"',ef.box.values.lWidth=d*b+ef.box[c].padding[1]+ef.box[c].padding[3],ef.box.values.lHeight=ef.box.values.maxHeight+ef.box[c].padding[0]+ef.box[c].padding[2],ef.box.values.left=(ef.box.values.wWidth-ef.box.values.lWidth)/2,ef.box.values.top=(ef.box.values.wHeight-ef.box.values.lHeight)/2):(f='width="'+ef.box.values.maxWidth+'"',ef.box.values.lWidth=ef.box.values.maxWidth+ef.box[c].padding[1]+ef.box[c].padding[3],ef.box.values.lHeight=e*a+ef.box[c].padding[0]+ef.box[c].padding[2],ef.box.values.left=(ef.box.values.wWidth-ef.box.values.lWidth)/2,ef.box.values.top=(ef.box.values.wHeight-ef.box.values.lHeight)/2):(f='width="'+ef.box.values.maxWidth+'"',ef.box.values.lWidth=ef.box.values.maxWidth+ef.box[c].padding[1]+ef.box[c].padding[3],ef.box.values.lHeight=e*a+ef.box[c].padding[0]+ef.box[c].padding[2],ef.box.values.left=(ef.box.values.wWidth-ef.box.values.lWidth)/2,ef.box.values.top=(ef.box.values.wHeight-ef.box.values.lHeight)/2):a>ef.box.values.maxHeight?(f='height="'+ef.box.values.maxHeight+'"',ef.box.values.lWidth=d*b+ef.box[c].padding[1]+ef.box[c].padding[3],ef.box.values.lHeight=ef.box.values.maxHeight+ef.box[c].padding[0]+ef.box[c].padding[2],ef.box.values.left=(ef.box.values.wWidth-ef.box.values.lWidth)/2,ef.box.values.top=(ef.box.values.wHeight-ef.box.values.lHeight)/2):(ef.box.values.lWidth=b+ef.box[c].padding[1]+ef.box[c].padding[3],ef.box.values.lHeight=a+ef.box[c].padding[0]+ef.box[c].padding[2],ef.box.values.left=(ef.box.values.wWidth-ef.box.values.lWidth)/2,ef.box.values.top=(ef.box.values.wHeight-ef.box.values.lHeight)/2),f},calcManualBoxSize:function(){ef.box.values.lWidth=1==ef.box.manualOptions.autoWidth?ef.box.values.maxDivWidth:ef.box.manualOptions.width,ef.box.values.lHeight=1==ef.box.manualOptions.autoHeight?ef.box.values.maxDivHeight:ef.box.manualOptions.height;var a=ef.box.manualOptions.padding[1]+ef.box.manualOptions.padding[3]+ef.box.manualOptions.margin[1]+ef.box.manualOptions.margin[3],b=ef.box.values.maxDivWidth+a,c=ef.box.manualOptions.padding[0]+ef.box.manualOptions.padding[2]+ef.box.manualOptions.margin[0]+ef.box.manualOptions.margin[2],d=ef.box.values.maxDivHeight+c;ef.box.values.left=b>ef.box.values.wWidth?20:(ef.box.values.wWidth-ef.box.values.lWidth)/2,ef.box.values.top=d>=ef.box.values.wHeight?20:(ef.box.values.wHeight-ef.box.values.lHeight)/2},calcImageSize:function(){var a=ef.box.values.img.height,b=ef.box.values.img.width;return this.calcBoxSize(a,b,"config")},calcContentSize:function(){return this.calcManualBoxSize()},contentLoaded:function(a){return 1==ef.box.values.closed?!1:("image"==a&&(attr=ef.box.calcImageSize(),ef.box.values.content='<img src="'+ef.box.values.img.src+'" '+attr+' alt="img" />',ef.box.showBox()),void 0)},contentError:function(a){"image"==a?this.values.content=this.config.errors.image:"inline"==a&&(this.values.content=this.config.errors.inline),this.showBox("error")},getWindowSize:function(){this.values.wWidth=jQuery(window).width(),this.values.wHeight=jQuery(window).height()},getMaxBoxSize:function(){this.getWindowSize(),this.values.maxDivWidth=this.values.wWidth-(this.config.margin[1]+this.config.margin[3]),this.values.maxDivHeight=this.values.wHeight-(this.config.margin[0]+this.config.margin[2])},getMaxImageSize:function(){this.values.maxWidth=this.values.maxDivWidth-(this.config.padding[1]+this.config.padding[3]),this.values.maxHeight=this.values.maxDivHeight-(this.config.padding[0]+this.config.padding[2])},getMaxDivSize:function(){this.values.maxWidth=this.values.maxDivWidth-(this.config.padding[1]+this.config.padding[3]),this.values.maxHeight=this.values.maxDivHeight-(this.config.padding[0]+this.config.padding[2])},setBoxSize:function(a,b){var c={width:this.values.lWidth,height:this.values.lHeight,top:this.values.top,left:this.values.left};1==a?"undefined"==typeof b?jQuery("#efBox").animate(c,this.config.resizeSpeed):jQuery("#efBox").animate(c,this.config.resizeSpeed,"linear",ef.box[b]):(jQuery("#efBox").css(c),"undefined"!=typeof b&&ef.box[b])},showLoading:function(){0==this.values.loading&&(this.values.loading=!0,jQuery("#efBoxLoading").fadeIn(this.config.speed))},hideLoading:function(){1==this.values.loading&&(this.values.loading=!1,jQuery("#efBoxLoading").fadeOut(this.config.speed))},showPrev:function(a,b){jQuery(".efBoxPrev").attr("data-name",a).attr("data-index",b-1).show()},hidePrev:function(){jQuery(".efBoxPrev").attr("data-name","").attr("data-index","").hide()},showNext:function(a,b){jQuery(".efBoxNext").attr("data-name",a).attr("data-index",b+1).show()},hideNext:function(){jQuery(".efBoxNext").attr("data-name","").attr("data-index","").hide()},arrows:function(){0!=ef.box.values.gallery&&(ef.box.values.index>0?ef.box.showPrev(ef.box.values.gallery,ef.box.values.index):ef.box.hidePrev(),ef.box.values.index<ef.box.values.galleries[ef.box.values.gallery].length-1?ef.box.showNext(ef.box.values.gallery,ef.box.values.index):ef.box.hideNext())},showBox:function(a){if(jQuery(".efContent").attr("class","efcontent "+a),jQuery("#efBox .efBoxContent").html(this.values.content),"iframe"==a){jQuery(".efBoxClose").addClass("hidden");var b=(ef.box.values.maxDivWidth-ef.box.config.width)/2;jQuery("#efBox").css({left:b+"px",top:"10px","box-shadow":"0px 0px 10px #000",width:ef.box.config.width,height:ef.box.values.divHeight})}jQuery("#efBoxOverlay").fadeIn(ef.box.config.speed),jQuery("#efBox").fadeIn(ef.box.config.speed),ef.box.arrows(),"iframe"!=a&&this.setBoxSize()},closeBox:function(){ef.box.values.closed=!0,ef.box.hideLoading(),jQuery("#efBoxOverlay").fadeOut(200),jQuery("#efBox").fadeOut(200,function(){$(this).children(".efBoxContent").html("")})},showContent:function(){jQuery(".efBoxContent").fadeIn(ef.box.config.speed),1==ef.box.config.navArrows&&0!=ef.box.values.gallery&&(ef.box.values.index>0&&ef.box.showPrev(ef.box.values.gallery,ef.box.values.index),ef.box.values.index<ef.box.values.galleries[ef.box.values.gallery].length-1&&ef.box.showNext(ef.box.values.gallery,ef.box.values.index))},hideContent:function(){jQuery(".efBoxContent").hide()},removeContent:function(){jQuery(".efBoxContent").html("")},openManually:function(a,b){jQuery.extend(this.manualOptions,a),this.getWindowSize(),this.getMaxBoxSize(),this.getMaxDivSize(),this.calcContentSize(),jQuery(".efBoxContent").length<=0&&this.attach(),this.values.content=this.manualOptions.content,this.showBox(),b()}};